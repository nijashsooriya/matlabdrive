
[x,y] = meshgrid(linspace(-1,1,100), linspace(-1,1,100));

u = @(x,y) 3*(1-3*x).^2.*exp(-2*x.^2 - (3*y+1).^2) ...
- 10*(3*x/5 - 27*x.^3 - 243*y.^5).*exp(-2*x.^2-6*y.^2) ...
- 1/3*exp(-(3*x+1).^2 - 9*y.^2) + (x.^2+y.^2) - 1;

contourf(x,y,u(x,y),20);
hold on;
title("Nijash Sooriyakumaran, 400185321")
colorbar;

SDX = @(x,y) -(18*(1-3*x)).*exp(-2*x.^2-(3*y+1).^2) ...
- 6*(1-3*x).^2.*2.*x.*exp(-2*x.^2-(3*y+1).^2) ...
- (10*(3/5-81*x.^2)).*exp(-2*x.^2-6*y.^2) ...
+ (20*((3/5)*x-27*x.^3-243*y.^5)).*2.*x.*exp(-2*x.^2-6*y.^2) ...
- (1/3*(-18*x-6)).*exp(-(3*x+1).^2-9*y.^2)+2*x; 
SDY = @(x,y) 3*(1-3*x).^2.*(-18*y-6).*exp(-2*x.^2-(3*y+1).^2) ...
+ 12150*y.^4.*exp(-2*x.^2-6*y.^2) ...
+ (20*((3/5)*x-27*x.^3-243*y.^5)).*6.*y.*exp(-2*x.^2-6*y.^2) ...
+ 6*y.*exp(-(3*x+1).^2-9*y.^2)+2*y;
hold on
quiver(x,y,SDX(x,y),SDY(x,y),'k')


tDomain =  [0:0.001:5.0];
r0 = [-.22,0.62];

rprime = @(t,x)[-1*(-(18*(1-3*x(1))).*exp(-2*x(1).^2-(3*x(2)+1).^2) ...
- 6*(1-3*x(1)).^2.*2.*x(1).*exp(-2*x(1).^2-(3*x(2)+1).^2) ...
- (10*(3/5-81*x(1).^2)).*exp(-2*x(1).^2-6*x(2).^2) ...
+ (20*((3/5)*x(1)-27*x(1).^3-243*x(2).^5)).*2.*x(1).*exp(-2*x(1).^2-6*x(2).^2) ...
- (1/3*(-18*x(1)-6)).*exp(-(3*x(1)+1).^2-9*x(2).^2)+2*x(1));-1*(3*(1-3*x(1)).^2.*(-18*x(2)-6).*exp(-2*x(1).^2-(3*x(2)+1).^2) ...
+ 12150*x(2).^4.*exp(-2*x(1).^2-6*x(2).^2) ...
+ (20*((3/5)*x(1)-27*x(1).^3-243*x(2).^5)).*6.*x(2).*exp(-2*x(1).^2-6*x(2).^2) ...
+ 6*x(2).*exp(-(3*x(1)+1).^2-9*x(2).^2)+2*x(2))];

[t r] = ode45(rprime,tDomain,r0);

[t(1:5001) r(1:5001,:)]

u = @(x,y) 3*(1-3*x).^2.*exp(-2*x.^2 - (3*y+1).^2) ...
- 10*(3*x/5 - 27*x.^3 - 243*y.^5).*exp(-2*x.^2-6*y.^2) ...
- 1/3*exp(-(3*x+1).^2 - 9*y.^2) + (x.^2+y.^2) - 1;

hold on
N=0;
for i = 1:5000 
    q = r(i,:);
    rr=u(q(1),q(2));
    
    if rr > 0
       N=N+1;
    end
end
    % plot(r(1:4,1),r(l:4,2),'w','linewidth',2)
 
     %plot(r(5:5001,1),r(5:5001,2),'k','linewidth',2)
    
   y1 = r(5000:5000,:);
   ANS = u(y1(1),y1(2));
   
   h1 = r(1:1,:);
   ans = u(h1(1),h1(2));
   
   pos_diff = abs(ans-ANS)

   
   diff_x = y1(1)-h1(1)
   diff_y = y1(2)-h1(2)
   
   length = sqrt(diff_x^2+diff_y^2+pos_diff^2);
   
   x=r(:,1);
   y=r(:,2);
   z=u(x,y);
   len=0;
   for i=1:5000
       dx(i)=x(i+1)-x(i);
       dy(i)=y(i+1)-y(i);
       dz(i)=z(i+1)-z(i);
       len=len+sqrt(dx(i)^2+dy(i)^2+dz(i)^2);
   end
   len
   length
       
   
   
   
